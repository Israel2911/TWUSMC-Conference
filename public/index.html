<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>TWU-SMC 11th Annual Leadership Conference</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <script src="/socket.io/socket.io.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
  
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { background: linear-gradient(135deg, #f0f4f8 0%, #d9e2ec 100%); font-family: 'Nunito', sans-serif; color: #1a365d; overflow-x: hidden; line-height: 1.6; }
    
    /* HEADER */
    .header { display: flex; align-items: center; justify-content: space-between; padding: 15px 40px; background: rgba(255,255,255,0.95); position: sticky; top: 0; z-index: 1000; backdrop-filter: blur(10px); box-shadow: 0 2px 20px rgba(0,0,0,0.05); }
    .logo { font-size: 1.5rem; font-weight: 900; color: #167690; }
    .nav { display: flex; gap: 20px; align-items: center; }
    .nav a { text-decoration: none; color: #167690; font-weight: 700; }
    
    .viewer-count { display: none; background: #ff0000; color: white; padding: 5px 15px; border-radius: 20px; font-size: 0.9rem; font-weight: bold; align-items: center; gap: 8px; animation: pulse-red 2s infinite; }
    
    /* HERO */
    .hero { position: relative; min-height: 80vh; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 80px 20px; transition: all 0.5s ease; overflow: hidden; }
    .hero-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 1; }
    .neural-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 2; background: radial-gradient(circle at 50% 50%, rgba(255, 215, 0, 0.2) 0%, transparent 60%); opacity: 0; animation: neural-fire 4s infinite ease-in-out; pointer-events: none; }
    @keyframes neural-fire { 0%, 100% { opacity: 0; transform: scale(0.8); } 50% { opacity: 1; transform: scale(1.2); } }

    .hero-content-standard { position: relative; z-index: 5; max-width: 1200px; width: 100%; transition: opacity 0.5s ease; }
    .hero-content-live { position: relative; z-index: 10; width: 100%; max-width: 1400px; display: none; margin-top: 20px; }
    .hero h1 { font-size: 4rem; font-weight: 900; color: #167690; margin:0; }
    .hero h2 { font-size: 2rem; color: white; margin: 10px 0 30px 0; }

    /* LIVE GRID */
    .live-grid { display: grid; grid-template-columns: 2.5fr 1fr; gap: 30px; min-height: 500px; }
    .video-wrapper { background: black; border-radius: 20px; overflow: hidden; border: 2px solid #333; position: relative; min-height: 400px; }
    .live-badge { position: absolute; top: 20px; left: 20px; background: #ff0000; color: white; padding: 5px 15px; border-radius: 5px; font-weight: bold; font-size: 0.9rem; z-index: 10; }
    .live-info-panel { background: rgba(0,0,0,0.8); backdrop-filter: blur(30px); padding: 30px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.15); color: white; text-align: left; display: flex; flex-direction: column; }
    .teams-btn { background: #464eb8; color: white; padding: 15px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; text-decoration: none; display: flex; align-items: center; gap: 10px; margin-top: 20px; width: 100%; justify-content: center; }

    /* GLOBAL SECTION - DEEP SPACE THEME */
    .global-connect-section { 
      position: relative; z-index: 5; 
      /* COSMIC GRADIENT FOR THE WHOLE SECTION */
      background: linear-gradient(135deg, #0a0e1a 0%, #1a1f35 50%, #000000 100%);
      padding: 80px 40px; 
      display: flex; flex-wrap: wrap; 
      justify-content: center; gap: 60px; 
      max-width: 1400px; margin: 0 auto; 
    }
    
    .globe-wrapper { 
      width: 500px; height: 500px; 
      position: relative; 
      border-radius: 50%; 
      /* DEEP SPACE GRADIENT FOR GLOBE CONTAINER */
      background: radial-gradient(circle at 40% 40%, #1e2636 0%, #000000 90%);
      border: 4px solid #333;
      box-shadow: 0 20px 50px rgba(0,0,0,0.5); 
      overflow: hidden;
    }

    /* STARS & SUNLIGHT OVERLAY */
    .globe-wrapper::before {
      content: "";
      position: absolute;
      inset: -10px;
      border-radius: 50%;
      pointer-events: none;
      mix-blend-mode: screen;
      background:
        /* Sunlight glow, top‚Äëleft */
        radial-gradient(circle at 20% 15%, rgba(255, 230, 150, 0.45) 0, transparent 55%),
        /* Stars */
        radial-gradient(circle at 75% 25%, rgba(255,255,255,0.9) 0 2px, transparent 2px),
        radial-gradient(circle at 30% 70%, rgba(255,255,255,0.7) 0 1.5px, transparent 1.5px),
        radial-gradient(circle at 60% 85%, rgba(255,255,255,0.6) 0 1.8px, transparent 1.8px);
      animation: starTwinkle 6s ease-in-out infinite;
    }
    @keyframes starTwinkle { 0%, 100% { opacity: 0.7; } 50% { opacity: 1; } }

    #heroGlobeContainer { width: 100%; height: 100%; border-radius: 50%; overflow: hidden; }
    
    .pause-btn { background: #167690; color: white; padding: 8px 20px; border: none; border-radius: 20px; cursor: pointer; font-weight: bold; font-size: 0.9rem; box-shadow: 0 4px 10px rgba(0,0,0,0.2); transition: 0.2s; }
    .pause-btn:hover { background: #128fa7; transform: scale(1.05); }

    .times-wrapper { flex: 1; min-width: 350px; max-width: 600px; }
    .globe-times-stack { display: flex; flex-direction: column; gap: 12px; }
    .globe-time-item { background: white; padding: 15px 25px; border-radius: 16px; border: 1px solid #edf2f7; border-left: 6px solid #ddd; display: grid; grid-template-columns: 1.5fr 1.5fr 1fr; align-items: center; box-shadow: 0 4px 12px rgba(0,0,0,0.03); transition: transform 0.2s; }
    .card-identity { display: flex; align-items: center; gap: 15px; }
    .globe-flag { font-size: 1.8rem; }
    .globe-name { font-weight: 800; color: #2d3748; font-size: 1.1rem; }
    .card-stats { display: flex; align-items: center; gap: 15px; color: #718096; font-size: 0.85rem; font-weight: 600; }
    .stat-pill { display: flex; align-items: center; gap: 6px; background: #f7fafc; padding: 4px 10px; border-radius: 20px; }
    .material-icons-round { font-size: 16px; color: #a0aec0; }
    .globe-time { font-family: 'Courier New', monospace; font-weight: 900; font-size: 1.4rem; color: #ff6b35; text-align: right; }

    /* SECTIONS */
    .section { padding: 80px 40px; max-width: 1200px; margin: 0 auto; text-align: center; }
    .section-header { font-size: 2.5rem; color: #167690; margin-bottom: 40px; font-weight:900; }
    .content-box { background: white; padding: 60px; border-radius: 30px; box-shadow: 0 20px 60px rgba(0,0,0,0.05); text-align: left; font-size: 1.1rem; }
    
    /* PDF */
    .pdf-wrapper { width: 100%; height: 500px; border: none; border-radius: 15px; background: #eee; }
    .pdf-btn { display: inline-block; background: #167690; color: white; padding: 15px 30px; border-radius: 30px; text-decoration: none; font-weight: bold; margin-top: 20px; transition: 0.2s; }
    .pdf-btn:hover { background: #128fa7; transform: translateY(-2px); }

    /* ADMIN (HIDDEN) */
    .admin-panel { position: fixed; bottom: 20px; right: 20px; z-index: 9999; display: none; gap: 10px; }
    .admin-btn { padding: 10px 20px; border-radius: 30px; cursor: pointer; font-weight: bold; border: 2px solid white; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
    .btn-live { background: #333; color: white; } 
    .btn-kill { background: #ff0000; color: white; display: none; }

    @keyframes pulse-red { 0% { opacity: 1; } 50% { opacity: 0.8; } 100% { opacity: 1; } }
    @keyframes pop { 0% { transform: scale(1); } 50% { transform: scale(1.2); color: #167690; } 100% { transform: scale(1); } }
    .pop { animation: pop 0.3s ease; }

    @media (max-width: 1024px) { .live-grid { grid-template-columns: 1fr; height: auto; } .hero { padding: 100px 20px; } }
    @media (max-width: 768px) { .globe-time-item { grid-template-columns: 1fr 1fr; gap: 10px; } .card-stats { grid-column: 1 / -1; justify-content: space-between; } .globe-wrapper { width: 300px; height: 300px; } }
  </style>
</head>
<body>

<!-- ADMIN CONTROLS -->
<div class="admin-panel" id="adminPanel">
  <button class="admin-btn btn-live" id="liveToggle">üî¥ Toggle "Go Live"</button>
  <button class="admin-btn btn-kill" id="killSwitch">‚ö†Ô∏è KILL STREAM</button>
</div>

<header class="header">
  <div class="logo">TWU-SMC Leadership</div>
  <nav class="nav">
    <div class="viewer-count" id="viewerCount">
      <span class="material-icons-round">visibility</span>
      <span id="countNum">0</span> Watching
    </div>
    <a href="#">Home</a>
    <a href="#synopsis">About</a>
    <a href="#agenda">Agenda</a>
    <a href="#resources">Resources</a>
  </nav>
</header>

<section class="hero">
  <img src="humanintelligence.png" alt="Background" class="hero-bg" id="heroBg">
  <div class="neural-overlay"></div>
  
  <div class="hero-content-standard" id="heroStandard">
    <h1>The Fifth Intelligence</h1>
    <h2>Integrating the Human Factor</h2>
  </div>

  <div class="hero-content-live" id="heroLive">
    <div class="live-grid">
      <div class="video-wrapper">
        <div class="live-badge">üî¥ LIVE</div>
        <iframe width="100%" height="100%" src="https://www.youtube.com/embed/live_stream?channel=YOUR_CHANNEL_ID" frameborder="0" allowfullscreen></iframe>
      </div>
      <div class="live-info-panel">
        <h2 style="margin:0 0 10px 0;">Live Q&A</h2>
        <p style="opacity:0.8;">Join the discussion via Teams.</p>
        <a href="https://teams.microsoft.com/meet/25727590322372?p=Toyeb2xMWy8NeEJiA2" target="_blank" class="teams-btn">
          <span class="material-icons-round">videocam</span> Join Teams Call
        </a>
      </div>
    </div>
  </div>
</section>

<section class="global-connect-section">
  <div class="globe-wrapper">
    <div id="heroGlobeContainer"></div> 
    <div style="position:absolute; bottom:10px; left:50%; transform:translateX(-50%);">
      <button class="pause-btn" id="pauseBtn">‚ñ∂ Start Rotation</button>
    </div>
  </div>
  <div class="times-wrapper">
    <h3 style="font-size: 2rem; color:#ffffff; margin-bottom:30px; font-weight:900;">üåç Global Community</h3>
    <div class="globe-times-stack" id="timeStack"></div>
  </div>
</section>

<section class="section" id="synopsis">
  <h2 class="section-header">Conference Overview</h2>
  <div class="content-box">
    <p>Welcome to the <strong>11th Annual TWU-SMC Leadership Conference</strong>. This year, we explore the frontier of <strong>"The Fifth Intelligence"</strong>‚Äîintegrating human creativity, moral reasoning, and emotional intelligence with AI.</p>
  </div>
</section>

<section class="section" id="agenda">
  <h2 class="section-header">Agenda</h2>
  <div class="content-box" style="padding:0; overflow:hidden;">
    <table class="agenda-table" style="width:100%; border-collapse:collapse;">
      <tr style="background:#167690; color:white;"><th style="padding:15px;">Time (IST)</th><th style="padding:15px;">Session</th></tr>
      <tr><td style="padding:15px; border-bottom:1px solid #eee;">10:00 AM</td><td style="padding:15px; border-bottom:1px solid #eee;">Keynote: Fifth Intelligence</td></tr>
      <tr><td style="padding:15px; border-bottom:1px solid #eee;">11:15 AM</td><td style="padding:15px; border-bottom:1px solid #eee;">Workshop: Human-AI Integration</td></tr>
      <tr><td style="padding:15px; border-bottom:1px solid #eee;">03:30 PM</td><td style="padding:15px; border-bottom:1px solid #eee;">Closing</td></tr>
    </table>
  </div>
</section>

<section class="section" id="resources">
  <h2 class="section-header">Resources</h2>
  <div class="content-box" style="text-align:center;">
    <h3>Conference Brochure</h3>
    <p style="margin-bottom:20px;">View the full schedule.</p>
    <iframe class="pdf-wrapper" src="brochure.pdf"></iframe>
    <br>
    <a href="brochure.pdf" download class="pdf-btn">
      <span class="material-icons-round" style="vertical-align:middle; margin-right:5px;">download</span> Download PDF
    </a>
  </div>
</section>

<script>
  const socket = io();
  const userTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
  socket.emit('report-location', userTimezone);

  const heroStandard = document.getElementById('heroStandard');
  const heroLive = document.getElementById('heroLive');
  const heroBg = document.getElementById('heroBg');
  const viewerCount = document.getElementById('viewerCount');
  const countNum = document.getElementById('countNum');
  const adminPanel = document.getElementById('adminPanel');
  const killSwitch = document.getElementById('killSwitch');

  // --- ADMIN LOGIC ---
  if (new URLSearchParams(window.location.search).get('mode') === 'admin') {
    localStorage.setItem('siteAdmin', 'true');
    window.history.replaceState({}, document.title, window.location.pathname);
  }
  
  if (localStorage.getItem('siteAdmin') === 'true') {
    adminPanel.style.display = 'flex';
  }

  socket.on('status-update', (isLive) => {
    if (isLive) {
      heroStandard.style.display = 'none';
      heroLive.style.display = 'block';
      heroBg.style.filter = 'brightness(0.2)';
      viewerCount.style.display = 'flex';
      if (localStorage.getItem('siteAdmin') === 'true') killSwitch.style.display = 'block';
    } else {
      heroLive.style.display = 'none';
      heroStandard.style.display = 'block';
      heroBg.style.filter = 'brightness(0.6)';
      viewerCount.style.display = 'none';
      killSwitch.style.display = 'none';
    }
  });

  socket.on('total-update', (count) => { countNum.innerText = count; });
  socket.on('region-update', (regionMap) => {
    countries.forEach((c, i) => {
      const el = document.getElementById(`count-${i}`);
      let count = regionMap[c.tz] || 0;
      if (el.innerText != count) { el.innerText = count; el.classList.add('pop'); setTimeout(() => el.classList.remove('pop'), 300); }
    });
  });

  document.getElementById('liveToggle').addEventListener('click', () => socket.emit('admin-toggle', true));
  document.getElementById('killSwitch').addEventListener('click', () => { if(confirm("KILL STREAM GLOBALLY?")) socket.emit('admin-toggle', false); });

  const countries = [
    {name: 'India', flag: 'üáÆüá≥', tz: 'Asia/Kolkata', lat: 22, lng: 78, color:'#FF9933'},
    {name: 'Canada', flag: 'üá®üá¶', tz: 'America/Vancouver', lat: 56, lng: -106, color:'#ff0000'},
    {name: 'Thailand', flag: 'üáπüá≠', tz: 'Asia/Bangkok', lat: 13, lng: 100, color:'#ffcc00'},
    {name: 'Europe', flag: 'üá™üá∫', tz: 'Europe/Paris', lat: 48, lng: 2, color:'#0000FF'},
    {name: 'UK', flag: 'üá¨üáß', tz: 'Europe/London', lat: 53, lng: -0.1, color:'#191970'},
    {name: 'USA', flag: 'üá∫üá∏', tz: 'America/New_York', lat: 39, lng: -98, color:'#003366'},
    {name: 'Singapore', flag: 'üá∏üá¨', tz: 'Asia/Singapore', lat: 1.3, lng: 103, color:'#EE2536'},
    {name: 'Malaysia', flag: 'üá≤üáæ', tz: 'Asia/Kuala_Lumpur', lat: 4, lng: 102, color:'#FFD700'}
  ];

  const stackEl = document.getElementById('timeStack');
  countries.forEach((c, i) => {
    stackEl.innerHTML += `
      <div class="globe-time-item" style="border-left-color:${c.color}">
        <div class="card-identity"><span class="globe-flag">${c.flag}</span><span class="globe-name">${c.name}</span></div>
        <div class="card-stats">
          <div class="stat-pill"><span class="material-icons-round">people</span><span id="count-${i}">0</span></div>
          <div class="stat-pill" id="weather-${i}"><span class="material-icons-round">wb_sunny</span></div>
        </div>
        <div class="globe-time" id="stack-time-${i}">--:--</div>
      </div>`;
  });

  function updateTimes() {
    const now = new Date();
    countries.forEach((c, i) => {
      document.getElementById(`stack-time-${i}`).innerText = now.toLocaleTimeString('en-GB', { timeZone: c.tz, hour:'2-digit', minute:'2-digit' });
      const hours = parseInt(new Date().toLocaleTimeString('en-GB', { timeZone: c.tz, hour:'numeric', hour12: false }));
      const icon = (hours >= 6 && hours < 18) ? 'wb_sunny' : 'bedtime';
      const color = (hours >= 6 && hours < 18) ? '#f6e05e' : '#718096';
      document.getElementById(`weather-${i}`).innerHTML = `<span class="material-icons-round" style="color:${color}">${icon}</span>`;
    });
  }
  setInterval(updateTimes, 1000); updateTimes();

  // --- 3D GLOBE SETUP ---
  const container = document.getElementById('heroGlobeContainer');
  const scene = new THREE.Scene();
  const camera = new THREE.PerspectiveCamera(45, 1, 0.1, 1000); 
  camera.position.z = 2.8; 
  
  const renderer = new THREE.WebGLRenderer({alpha: true, antialias: true});
  renderer.setSize(500, 500); 
  container.appendChild(renderer.domElement);
  
  const controls = new THREE.OrbitControls(camera, renderer.domElement);
  controls.enableDamping = true; 
  // --- START PAUSED TO KEEP THE VIEW CORRECT ---
  controls.autoRotate = false; 
  
  scene.add(new THREE.AmbientLight(0xffffff, 1.0));
  const dLight = new THREE.DirectionalLight(0xffffff, 0.5); 
  dLight.position.set(5,3,5); 
  scene.add(dLight);
  
  const globeGroup = new THREE.Group(); 
  scene.add(globeGroup);
  
  // --- DEAD CENTER VIEW: INDIAN OCEAN / AFRICA / ASIA ---
  globeGroup.rotation.y = -0.8; 

  new THREE.TextureLoader().load('https://upload.wikimedia.org/wikipedia/commons/thumb/c/cd/Land_ocean_ice_2048.jpg/1024px-Land_ocean_ice_2048.jpg', tex => {
    globeGroup.add(new THREE.Mesh(new THREE.SphereGeometry(1, 64, 64), new THREE.MeshPhongMaterial({map: tex, specular: 0x111111, shininess: 5})));
  });

  const flagSprites = [];
  function latLonToVec3(lat, lon, r) {
    const phi = (90 - lat) * (Math.PI/180), theta = (lon + 180) * (Math.PI/180);
    return new THREE.Vector3(-r * Math.sin(phi) * Math.cos(theta), r * Math.cos(phi), r * Math.sin(phi) * Math.sin(theta));
  }
  
  function createLabel(country) {
    const canvas = document.createElement('canvas'); canvas.width = 300; canvas.height = 150;
    const ctx = canvas.getContext('2d');
    drawCanvas(ctx, country, "--:--");
    const tex = new THREE.CanvasTexture(canvas);
    const sprite = new THREE.Sprite(new THREE.SpriteMaterial({map: tex}));
    sprite.position.copy(latLonToVec3(country.lat, country.lng, 1.3)); 
    sprite.scale.set(0.8, 0.4, 1); 
    globeGroup.add(sprite);
    return { sprite, ctx, country, tex };
  }
  
  function drawCanvas(ctx, country, timeStr) {
    ctx.clearRect(0,0,300,150);
    // DARK BACKGROUND
    ctx.fillStyle = 'rgba(10, 16, 30, 0.85)'; 
    ctx.beginPath(); 
    const r = 20; const x = 10, y = 10, w = 280, h = 130;
    ctx.moveTo(x+r, y); ctx.lineTo(x+w-r, y); ctx.quadraticCurveTo(x+w, y, x+w, y+r);
    ctx.lineTo(x+w, y+h-r); ctx.quadraticCurveTo(x+w, y+h, x+w-r, y+h);
    ctx.lineTo(x+r, y+h); ctx.quadraticCurveTo(x, y+h, x, y+h-r);
    ctx.lineTo(x, y+r); ctx.quadraticCurveTo(x, y, x+r, y);
    ctx.closePath(); ctx.fill();
    
    // BORDER & TEXT
    ctx.lineWidth = 6; ctx.strokeStyle = country.color; ctx.stroke();
    ctx.fillStyle = '#FFFFFF'; ctx.font = 'bold 38px Arial'; 
    ctx.fillText(country.flag + " " + country.name.substring(0,3).toUpperCase(), 40, 65); 
    ctx.fillStyle = '#00FF88'; ctx.font = 'bold 45px Courier New'; 
    ctx.fillText(timeStr, 50, 115);
  }

  countries.forEach(c => flagSprites.push(createLabel(c)));

  function updateSprites() {
    const now = new Date();
    flagSprites.forEach(item => {
      const timeStr = now.toLocaleTimeString('en-GB', { timeZone: item.country.tz, hour:'2-digit', minute:'2-digit' });
      drawCanvas(item.ctx, item.country, timeStr);
      item.tex.needsUpdate = true;
    });
  }
  setInterval(updateSprites, 1000);
  updateSprites();

  document.getElementById('pauseBtn').onclick = function() { controls.autoRotate = !controls.autoRotate; this.innerText = controls.autoRotate ? '‚è∏ Pause' : '‚ñ∂ Start Rotation'; };
  function animate() { requestAnimationFrame(animate); controls.update(); renderer.render(scene, camera); }
  animate();
</script>
</body>
</html>
